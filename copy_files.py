import os
import shutil
import pandas as pd

# Paths
 
folder1 = r"C:\Users\Pranjali.Alure\OneDrive - Reliance Corporate IT Park Limited\Desktop\LB\Arul sir\RERA automation\Files_2025_2023"           # Files like project_id_1
folder2 = r"C:\Users\Pranjali.Alure\OneDrive - Reliance Corporate IT Park Limited\Desktop\LB\Arul sir\RERA automation\View_Original_Application"          # Files like project_id
folder3 = r"C:\Users\Pranjali.Alure\OneDrive - Reliance Corporate IT Park Limited\Desktop\LB\Arul sir\RERA automation\Mumbai_Data\View Apllication"           # Destination for Folder1 files
folder4 = r"C:\Users\Pranjali.Alure\OneDrive - Reliance Corporate IT Park Limited\Desktop\LB\Arul sir\RERA automation\Mumbai_Data\View_original_application"         # Destination for Folder2 files

os.makedirs(folder3, exist_ok=True)
os.makedirs(folder4, exist_ok=True)

# Read Project IDs
df_projects = ['P51700051406',	'P51700052485',	'P51800077401',	'P51700077697',	'P51700078670',	'P51700004772',	'P51800014914',	'P51900018039',	'P51900020330',	'P51700024580',	'P51800030148',	'P51700031649',	'P51900034288',	'P51700045497',	'P51700046312',	'P51700046313',	'P51800050591',	'P51700054070',	'P51800054588',	'P51700056061',	'P51700055323',	'P51700056190',	'P51700076796',	'PR1180002500072',	'PR1330002500231',	'PR1180002500233',	'PC1330002500238',	'P51700080790',	'P51700080793',	'P51800000956',	'P51900007684',	'P51900017229',	'P51800019930',	'P51700020335',	'P51700027947',	'P51800032578',	'P51800032948',	'P51700034385',	'P51700046184',	'P51800046698',	'P51700054749',	'P51800077200',	'P51700078356',	'P51700078879',	'P51800079254',	'P51700079542',	'PR1180002500223',	'P51900080218',	'PR1180002500225',	'PM1330002500227',	'PR1330002500228',	'PM1180002500229',	'P51800080779',	'P51700080781',	'P51700080782',	'P51800080783',	'P51700080784',	'P51700080786',	'P51800032308',	'P51700076610',	'PR1180002400010',	'P51800079081',	'P51700047534',	'P51900049902',	'P51800052226',	'P51700051424',	'PM1180002500170',	'P51800080246',	'PM1330002500128',	'P51900080252',	'PR1180002500210',	'P51900006786',	'P51800003263',	'P51700009540',	'P51900012891',	'P51700017401',	'P51700019657',	'P51700029198',	'P51700046135',	'P51800048242',	'P51800056375',	'P51800079964',	'P51800080074',	'P51800080163',	'PM1180002500211',	'PM1330002500212',	'PR1180002500214',	'PR1330002500215',	'PM1330002500216',	'PR1180002500220',	'PR1180002500206',	'PR1180002500205',	'PM1330002500202',	'P51700080773',	'P51800005812',	'P51700011183',	'P51700006603',	'P51700018341',	'P51900018301',	'P51800020431',	'P51800026006',	'P51700030770',	'P51800051682',	'P51700052393',	'P51800052907',	'P51800053218',	'P51900077577',	'P51700077757',	'P51700079820',	'PR1180002500195',	'PR1332022500196',	'PM1180002500188',	'PR1330002500199',	'P51700080748',	'P51700080751',	'P51700080753',	'P51800080759',	'P51800021322',	'P51700027814',	'P51800030506',	'P51800048036',	'P51700048753',	'P51800051199',	'P51800050853',	'P51800056326',	'P51800076983',	'PM1180002400053',	'P51700078895',	'PM1180002500076',	'PR1180002500153',	'P51800002652',	'P51800011529',	'P51700030955',	'P51800045723',	'P51700048693',	'P51700051567',	'P51800056010',	'P51800056390',	'P51800056223',	'P51700079168',	'PM1330002500176',	'PM1330002500185',	'P51700080735',	'P51700080738',	'P51700005345',	'P51800009600',	'P51900016804',	'P51700018294',	'P51800020300',	'P51700028840',	'P51800029355',	'P51700047364',	'P51700048339',	'P51800052413',	'P51800052927',	'P51800052504',	'P51800077162',	'P51900077936',	'PR1180002500164',	'PM1330002500168',	'PM1170002500151',	'PR1330002500159',	'P51700080725',	'P51800080727',	'P51900080731',	'P51700080732',	'P51800080733',	'P51700045401',	'P51700007989',	'P51700005750',	'P51800032448',	'P51700026692',	'P51800029900',	'P51700034703',	'P51800050026',	'P51700053764',	'P51700078231',	'PR1181012500079',	'PR1180002500146',	'PR1170002500147',	'PR1330002500148',	'P51800080333',	'P51900080718',	'P51900080719',	'P51700080720',	'P51700001729',	'P51800018893',	'P51700029763',	'P51800031248',	'P51800034172',	'P51900046567',	'P51800076650',	'P51800056369',	'P51800076677',	'P51800056457',	'P51700079171',	'PM1180002500057',	'PM1180002500137',	'P51800080704',	'P51700080711',	'P51700008912',	'P51800010872',	'P51800007245',	'P51700020319',	'P51700020942',	'P51800027919',	'P51700030100',	'P51800046666',	'P51700049444',	'P51700048857',	'P51700050785',	'P51700056333',	'P51800077688',	'P51700079552',	'P51700079613',	'P51800079755',	'PR1180002500124',	'PM1330002500130',	'PR1330002500134',	'P51700080683',	'P51700080691',	'P51800080693',	'P51700080694',	'P51700080695',	'P51800080700',	'P51900021057',	'P51700026430',	'P51800034083',	'P51700054437',	'P51800079104',	'P51700079338',	'PR1332022500106',	'PM1330002500117',	'PM1330002500118',	'PM1180002500121',	'P51800003675',	'P51800007051',	'P51800011168',	'P51800011760',	'P51800007259',	'P51700012982',	'P51900013981',	'P51700015939',	'P51900021418',	'P51700022222',	'P51700023241',	'P51800023938',	'P51700026198',	'P51800026955',	'P51800030554',	'P51700030580',	'P51800032059',	'P51800032668',	'P51800033680',	'P51900035094',	'P51800035190',	'P51800045886',	'P51700047233',	'P51700049887',	'P51800053645',	'P51800077652',	'PM1330002500114',	'PM1180002500115',	'PM1180002500096',	'PM1330002500105',	'PM1180002500102',	'PR1330002500101',	'PM1180002500099',	'PM1180002500091',	'PR1330002500089',	'PR1181012500087',	'P51700080542',	'P51700080620',	'P51700080622',	'P51700080623',	'P51800080624',	'P51700080639',	'P51800080642',	'P51700080650',	'P51700080658',	'P51800080660',	'P51800080667',	'P51700080669',	'P51700080671',	'P51700080672',	'P51700050794',	'P51800076772',	'P51800078202',	'P51700080193',	'P51700049026',	'P51700047011',	'P51700049248',	'P51800053415',	'P51800078981',	'P51800049834',	'P51800077126',	'P51700078378',	'PM1330002500083',	'PC1180002500084']
df_projects = pd.DataFrame(df_projects)
project_ids = df_projects[0].values

# Get file names
files_folder1 = {os.path.splitext(f)[0]: f for f in os.listdir(folder1) if os.path.isfile(os.path.join(folder1, f))}
files_folder2 = {os.path.splitext(f)[0]: f for f in os.listdir(folder2) if os.path.isfile(os.path.join(folder2, f))}

# Check presence and copy files
results = []
for pid in project_ids:
    file1_name = f"{pid}_2" if f"{pid}_2" in files_folder1 else None
    file2_name = pid if pid in files_folder2 else None

    in_folder1 = file1_name is not None
    in_folder2 = file2_name is not None
    results.append([pid, in_folder1, in_folder2])

    if in_folder1 and in_folder2:
        # Copy Folder1 file to Folder3
        shutil.copy2(os.path.join(folder1, files_folder1[file1_name]), os.path.join(folder3, files_folder1[file1_name]))
        # Copy Folder2 file to Folder4
        shutil.copy2(os.path.join(folder2, files_folder2[file2_name]), os.path.join(folder4, files_folder2[file2_name]))

# Save presence info to Excel
df_result = pd.DataFrame(results, columns=["Project ID", "In Folder1", "In Folder2"])
output_file = r"C:\Users\Pranjali.Alure\OneDrive - Reliance Corporate IT Park Limited\Desktop\LB\Arul sir\RERA automation\Mumbai_Data\Files_availbale.xlsx"

df_result.to_excel(output_file, index=False)

print(f"Check completed. Results saved to {output_file}")
